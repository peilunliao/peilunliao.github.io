<!DOCTYPE html>
<html>
<head>
	<title>Painter</title>
	<link rel="icon" href="../smile.gif" type="image/gif" sizes="16x16">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://fonts.googleapis.com/css?family=Amatic+SC|Calligraffitti" rel="stylesheet">
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script>

	<script>
    var pic = document.getElementsByClassName('painter');
    function main(){
      $('.painter').hide();
      $('.painter').fadeIn(900);
    }
    $(document).ready(main);
  	</script>

	<style>
		*{
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		@media only screen and (max-width: 930px) {
	      .disappear{display: none;} 
		} 
		@media only screen and (min-width: 930px){
			.navBar ul li {float: left;}
		}
		@media only screen and (orientation: landscape)  {
	    /* For tablets: */
	    
	    #words {font-size: 30px;}
	    .alert{ display: none; }   
		}
		
		body{
			background-color: #ffffcc;
		}
		canvas{
			/*position: absolute;
			top:6%;
			left:28%;*/
			margin: auto;
			margin-top: 10px;
			display: block;
			border: 2px solid black;
			background-color: white;
			cursor: url('paintcursor.gif'),pointer;
		}
		.navBar ul {
			list-style-type: none;
			margin: 0;
			padding: 0;
			overflow: hidden;
			background-color: #333;
			min-width: 600px;

		}
		
		.navBar ul li a {
			display:block;
			color: white;
			text-align: center;
			padding: 18px 24px;
			font-size: 15px;
			text-decoration: none;
			font-family: "Courier New", "Arial Black", "Serif";

		}

		li a:hover {
			background-color: #111;
		}
		.painter{
			position: relative;
			width:600px;
			height:270px; 
			margin: auto;
			margin-top: 50px;
			
		}
		.size p, .colors p{
			padding-bottom:10px;
			font-size: 12px;

		}
		.colors{
			position: absolute;
			top:0;
			right: 0;
			text-align: center;
			font-family: Courier, "Arial Black", "Serif";			
		}
		#large:hover, #blackpic:hover, #redpic:hover, #bluepic:hover, #greenpic:hover{
			position: relative;
			right:1px;
			bottom:1px;
			cursor: pointer;
		}
		#blackpic, #redpic,#bluepic,#greenpic{
			height: 50px;
			width: 50px;
		}
		#eraserpic{
			height: 50px;
			width: 40px;
		}
		#large{
			height: 40px;
			width: 40px;
		}
		.size{
			height: 150px;
			position: absolute;
			left:2%;
			top:0;
			text-align: center;
			font-family: Courier, "Arial Black", "Serif";
		}
		#middle{
			position: absolute;
			left:15%;
			top:50%;
		}
		#middle:hover{
			position: absolute;
			left:14%;
			top: 49%;
			cursor: pointer;
		}
		#small{
			position: absolute;
			left:30%;
			top:75%;
		}
		#small:hover{
			position: absolute;
			left:29%;
			top: 74%;
			cursor: pointer;
		}
		#eraser{
			position: absolute;
			left:2%;
			top:60%;
		}
		#eraser:hover{
			position: absolute;
			left: 1.7% ;
			top: 59.5% ;
			cursor: pointer;
		}
		img{
			display: block;
		}
		button{
			position: absolute;
			left:8px;
			bottom:0;
			background-color: #6666ff;
    		border: none;
    		color: white;
    		padding: 10px 10px;
    		text-align: center;
    		font-size: 12px;
    		margin: 2px 1px;
    		cursor: pointer;
    		border-radius: 12px;
    		font-family: Courier, "Arial Black", "Serif";
		}
		button:hover{
			position: absolute;
			left:7px;
			bottom: 1px;
		}
		#words{
			margin: auto;
			margin-top: 30px;
			font-family: 'Calligraffitti', cursive;
			text-align: center;
			width: 100%;
			min-width: 600px;
		}
		.alert {
			margin-top: 10px;
		    padding: 20px;
		    background-color: #f44336;
		    color: white;
		    font-family: Courier, "Arial Black", "Serif";
		}

		.closebtn {
		    margin-left: 15px;
		    color: white;
		    font-weight: bold;
		    float: right;
		    font-size: 22px;
		    line-height: 20px;
		    cursor: pointer;
		    transition: 0.3s; 
		}

		.closebtn:hover {
		    color: black;
		}
	</style>

</head>
<body>
<div class=navBar>
	<ul>
		<li><a href="../peilunliao.html">HOME</a></li>
		<div class="disappear">
		<li><a href="../quote/quote.html">QUOTES NOTING</a></li>
		<li><a href="../timer/timer.html">COUNTDOWN TIMER</a></li>
		<li><a href="../slideshow/slideshow.html">PHOTO SLIDESHOW</a></li>
		<li><a href="../game/game.html">LITTLE SPACE GAME</a></li>
		<li><a href="paint.html">PAINTER</a></li>
		</div>
	</ul>
</div>
<div class="alert">
  <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
  <strong>NOTICE!</strong> For mobile user<br>
	Please turn your device's orientation to fit the canvas. 
</div>
<div class="painter">
	<div>
	<canvas id = "canvas" width="450" height="250"></canvas>
	</div>
	<div class="colors">
		<p>Colors<br></p>
		<img id="blackpic" src="blackcolor.png">
		<img id="redpic" src="redcolor.png">
		<img id="bluepic" src="bluecolor.png">
		<img id="greenpic" src="greencolor.png">
	</div>
	<div class="size">
		<p>Size<br></p>
		<img id="large" src="large.png">
		<img id="middle" src="middle.png">
		<img id="small" src="small.png">
	</div>
	<div id="eraser">
		<img id="eraserpic" src="eraser.png">
	</div>
	<button id="button">Clear</button>
	</div>
	<div id="words">
	<p>This is the little paint game I created. Please give it a try!<br>
	You can change the size and color of stroke by tapping the images.<br>
	Let's start and find out what you can create !!<br>
	* For Mobile user, softly tap the canvas to make it fit the screen before you start drawing!
	</p>
	</div>

<script>
	var clickx = new Array();
	var clicky = new Array();
	var ongoingTouches = [];
	var color = "black";
	var width = 6;
	var md = false;
	var canvas = document.getElementById('canvas');
	var context = canvas.getContext('2d');
	canvas.addEventListener('mousedown', down);
	canvas.addEventListener('mouseup', toggledraw);
	canvas.addEventListener('mousemove',
	function(evt){
		var mousePos = getMousePos(canvas, evt);
		var posx = mousePos.x;
		var posy = mousePos.y;
		clickx.push(posx);
		clicky.push(posy);
		draw(canvas, posx, posy);
	});
	
	function down(){
		md = true;
	}
	function toggledraw(){
		md = false;
		canvas.style.cursor="url('paintcursor.gif'), pointer";
	}
	
	function getMousePos(canvas, evt){
		var rect = canvas.getBoundingClientRect();
		return{
			x:evt.clientX - rect.left,
			y:evt.clientY - rect.top
		};
	}
	canvas.addEventListener("touchstart", handleStart, false);
  	canvas.addEventListener("touchend", handleEnd, false);
  	canvas.addEventListener("touchcancel", handleCancel, false);
  	canvas.addEventListener("touchmove", handleMove, false);
	function handleStart(evt){
		evt.preventDefault();
		$("html, body").animate({ scrollTop: 0 }, 300);
		$("html, body").animate({ scrollLeft: 0 }, 300);
		var touches = evt.changedTouches;
		var rect = canvas.getBoundingClientRect();
		for (var i = 0; i < touches.length; i++) {
    		ongoingTouches.push(copyTouch(touches[i]));
    		context.beginPath();
    		context.arc(touches[i].pageX - rect.left, touches[i].pageY - rect.top, width/2 , 0, 2 * Math.PI, false);  // a circle at the start
    		context.fillStyle = color;
    		context.fill();
	      }
	}
	function handleMove(evt) {
	  evt.preventDefault();
	  var touches = evt.changedTouches;
	  var rect = canvas.getBoundingClientRect();
	    for (var i = 0; i < touches.length; i++) {
	    var idx = ongoingTouchIndexById(touches[i].identifier);
	    if (idx >= 0) {
	        context.beginPath();
	 	context.arc(touches[i].pageX - rect.left, touches[i].pageY - rect.top, width/2 , 0, 2 * Math.PI, false);
		context.fillStyle = color;
    		context.fill();    
	      context.beginPath();      
	      context.moveTo(ongoingTouches[idx].pageX - rect.left, ongoingTouches[idx].pageY - rect.top);
	      context.lineTo(touches[i].pageX - rect.left, touches[i].pageY - rect.top);
	      context.lineWidth = width;
	      context.strokeStyle = color;
	      context.stroke();
	      ongoingTouches.splice(idx, 1, copyTouch(touches[i]));  // swap in the new touch record
	    } 
	  }
	}
	function handleEnd(evt) {
	  evt.preventDefault();
	  var touches = evt.changedTouches;
	  var rect = canvas.getBoundingClientRect();
	  for (var i = 0; i < touches.length; i++) {
	    var idx = ongoingTouchIndexById(touches[i].identifier);
	    if (idx >= 0) {
	      context.lineWidth = width;
	      context.fillStyle = color;
	      context.beginPath();
	      context.moveTo(ongoingTouches[idx].pageX - rect.left , ongoingTouches[idx].pageY - rect.top);
	      context.lineTo(touches[i].pageX - rect.left, touches[i].pageY - rect.top);
	      ongoingTouches.splice(idx, 1);  // remove it; we're done
	    } 
	  }
	}
	function handleCancel(evt) {
	  evt.preventDefault();
	  var touches = evt.changedTouches;
	  for (var i = 0; i < touches.length; i++) {
	    var idx = ongoingTouchIndexById(touches[i].identifier);
	    ongoingTouches.splice(idx, 1);  // remove it; we're done
	  }
	}
	function copyTouch(touch) {
  	return { identifier: touch.identifier, pageX: touch.pageX, pageY: touch.pageY };
	}
	function ongoingTouchIndexById(idToFind) {
	  for (var i = 0; i < ongoingTouches.length; i++) {
	    var id = ongoingTouches[i].identifier;
	    if (id == idToFind) {
	      return i;
	    }
	  }
	  return -1;    // not found
	}	
	$(document).ready(function(){
		$("#redpic").click(function(){
			color = "#FF8080";
		});
		$("#bluepic").click(function(){
			color = "#80AAFF";	
		});
		$("#greenpic").click(function(){
			color = "#85e085";	
		});
		$("#blackpic").click(function(){
			color = "black";	
		});
		$("#eraserpic").click(function(){
			color = "white";	
		});
	});

	$(document).ready(function(){
		$("#large").click(function(){
			width = 30;
		});
		$("#middle").click(function(){
			width = 10;	
		});
		$("#small").click(function(){
			width = 6;	
		});
		
	});

	document.getElementById('button').addEventListener('click', function() {
        context.clearRect(0, 0, canvas.width, canvas.height);
      }, false);

	function draw(canvas, posx, posy){
		var i = clickx.length;
		var j = clicky.length;
		if(md){
			canvas.style.cursor="url('paintcursor.gif'), pointer";
			context.beginPath();
			context.arc(posx,posy,width/2,0,2*Math.PI);
			context.fillStyle = color;
			context.fill();
			context.beginPath();
			if( i> 1 && j > 1){
				context.moveTo(clickx[i-2],clicky[j-2]);
			}else{
				context.moveTo(clickx[i-1],clicky[j-1]);
			}
			context.lineTo(clickx[i-1],clicky[j-1]);
			context.closePath();
			context.lineWidth= width;
			context.strokeStyle = this.color;
			context.stroke(); 

			
		}
	}
	
</script>
</body>
</html>
